
Private Function BuildKey(ws As Worksheet, rowNum As Long, cols As Collection) As String
    
    Dim key As String
    Dim colName As Variant
    Dim colIndex As Variant
    
    key = ""
    
    For Each colName In cols
        colIndex = Application.Match(colName, ws.Rows(1), 0)
        
        If Not IsError(colIndex) Then
            key = key & "|" & Trim(CStr(ws.Cells(rowNum, colIndex).Value))
        Else
            key = key & "|"
        End If
    Next colName
    
    BuildKey = key

End Function


Private Function CountDuplicateGroups(dict As Object) As Long
    Dim k As Variant, c As Long
    c = 0
    For Each k In dict.Keys
        If dict(k).Count > 1 Then c = c + 1
    Next k
    CountDuplicateGroups = c
End Function


Private Function CountDuplicateRows(dict As Object) As Long
    Dim k As Variant, c As Long
    c = 0
    For Each k In dict.Keys
        If dict(k).Count > 1 Then
            c = c + dict(k).Count
        End If
    Next k
    CountDuplicateRows = c
End Function
